sourceSets {
    main {
        java {
            srcDirs 'src/main/java'
            srcDirs 'AVRcore/src'
        }
    }
}

task submodulesUpdate(type: Exec) {
    description 'Updates (and inits) git submodules'
    group 'Build Setup'
    commandLine 'git', 'submodule', 'update', '--init', '--recursive', '--remote'
}

setupCIWorkspace.dependsOn submodulesUpdate
setupDevWorkspace.dependsOn submodulesUpdate
setupDecompWorkspace.dependsOn submodulesUpdate
compileJava.dependsOn submodulesUpdate
sourceMainJava.dependsOn submodulesUpdate